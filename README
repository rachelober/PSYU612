I'm sorry, this is awful code. I wrote this years ago when I was just starting to learn Ruby on Rails. This is here mainly to get it out of Subversion!